<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>biotools: an overview • biotools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="biotools: an overview">
<meta property="og:description" content="biotools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biotools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/overview.html">biotools: an overview</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/arsilva87/biotools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>biotools: an overview</h1>
                        <h4 class="author">Anderson R da Silva</h4>
            
            <h4 class="date">2021-08-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/arsilva87/biotools/blob/master/vignettes/overview.Rmd"><code>vignettes/overview.Rmd</code></a></small>
      <div class="hidden name"><code>overview.Rmd</code></div>

    </div>

    
    
<div id="about" class="section level1">
<h1 class="hasAnchor">
<a href="#about" class="anchor"></a>About</h1>
<p><em>biotools</em> has implementations to perform and work with cluster analysis, especially Tocher's method, and tools for evaluating clustering outcomes, such as a specific coefficient of cophenetic correlation, discriminant analysis, the Box'M test and the Mantel's permutation test. A new approach for calculating the power of Mantel's test is implemented. Some of those are illustrated in the next sections.</p>
<p>Target audience: agronomists, biologists and researchers of related fields.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version on CRAN or the beta version from GitHub:</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"biotools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"arsilva87/biotools"</span><span class="op">)</span></code></pre></div>
<p>Load it:</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">biotools</span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## ---
## biotools version 4.1</code></pre>
<pre><code>## </code></pre>
</div>
</div>
<div id="multivariate-pairwise-comparisons" class="section level1">
<h1 class="hasAnchor">
<a href="#multivariate-pairwise-comparisons" class="anchor"></a>Multivariate pairwise comparisons</h1>
<p>Take the data set <code>maize</code> from biotools. They consist of multivariate observations on ears of five maize genotypes (families).</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">maize</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">maize</span><span class="op">)</span>   <span class="co"># firts 6 rows</span></code></pre></div>
<pre><code>##       NKPR       ED       CD       PH family env
## 1 36.02031 4.333750 2.317500 2.087813      1   1
## 2 34.24688 4.045000 2.251250 1.892187      2   1
## 3 28.12656 3.741250 2.141250 2.119375      3   1
## 4 30.72500 4.321875 2.288125 2.085000      4   1
## 5 34.00625 4.660000 2.500625 2.100312      5   1
## 6 36.50000 4.328750 2.436250 2.196875      1   2</code></pre>
<p>Let us fit a MANOVA model and test for statistical significance of 'family' using Wilks' lambda.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">NKPR</span>, <span class="va">ED</span>, <span class="va">CD</span><span class="op">)</span> <span class="op">~</span> <span class="va">family</span>, data <span class="op">=</span> <span class="va">maize</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">M</span>, test <span class="op">=</span> <span class="st">"Wilks"</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
##             Df    Wilks approx F num Df den Df  Pr(&gt;F)    
## (Intercept)  1 0.001322   3272.8      3 13.000 &lt; 2e-16 ***
## family       4 0.100255      4.0     12 34.686 0.00066 ***
## Residuals   15                                            
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>Now, one question is <strong>where</strong> are those differences? To answer that, multiple pairwise tests can be run. The function <code><a href="../reference/mvpaircomp.html">mvpaircomp()</a></code> allows on to choose between multivariate statistics such as Wilks' lambda, Pillai's trace etc. to perform multiple tests on factor levels a fitted model.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mvpaircomp.html">mvpaircomp</a></span><span class="op">(</span><span class="va">M</span>, <span class="st">"family"</span>, test <span class="op">=</span> <span class="st">"Wilks"</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##             Multivariate Pairwise Comparisons
## 
##         Wilks approx F num DF den DF   Pr(&gt;F)   
## 1 - 2 0.57758   3.1693      3     13 0.604689   
## 1 - 3 0.32690   8.9225      3     13 0.017946 * 
## 1 - 4 0.55591   3.4616      3     13 0.480571   
## 1 - 5 0.67364   2.0994      3     13 1.000000   
## 2 - 3 0.61192   2.7482      3     13 0.853092   
## 2 - 4 0.60398   2.8413      3     13 0.789525   
## 2 - 5 0.46341   5.0176      3     13 0.158342   
## 3 - 4 0.31965   9.2230      3     13 0.015581 * 
## 3 - 5 0.24296  13.5019      3     13 0.002738 **
## 4 - 5 0.80370   1.0584      3     13 1.000000   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## With bonferroni p-value adjustment for multiple comparisons</code></pre>
<div id="boxs-m-test" class="section level2">
<h2 class="hasAnchor">
<a href="#boxs-m-test" class="anchor"></a>Box's M-test</h2>
<p>One requirement of the model fitted earlier is that is residual covariance matrices of the factor levels are homogeneous. Furthermore, in cluster analysis, it might be of interest to check if the covariance matrices of the clusters can be considered equals, especially if one intends to perform a linear discriminant analysis using a pooled matrix.In those cases, the Box's M-test can be applied. The function <code><a href="../reference/boxM.html">boxM()</a></code> performs the test using an approximation of the <span class="math inline">\(\chi^2_\nu\)</span> distribution, where <span class="math inline">\(\nu = \frac{p(p+1)(k-1)}{2}\)</span>, <span class="math inline">\(p\)</span> is the number of variables and <span class="math inline">\(k\)</span> is the number of levels.</p>
<p>Users should be aware that all clusters must have a positive definite covariance matrix. If there is any cluster/level containing fewer observations (rows) than the number of variables (columns), then its covariance matrix is probably not positive definite.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>
<span class="fu"><a href="../reference/boxM.html">boxM</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">res</span>, grouping <span class="op">=</span> <span class="va">maize</span><span class="op">$</span><span class="va">family</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Box's M-test for Homogeneity of Covariance Matrices
## 
## data:  res
## Chi-Sq (approx.) = 32.517, df = 24, p-value = 0.1147</code></pre>
</div>
</div>
<div id="importance-of-variables-the-singhs-criterion" class="section level1">
<h1 class="hasAnchor">
<a href="#importance-of-variables-the-singhs-criterion" class="anchor"></a>Importance of variables: the Singh's criterion</h1>
<p>The function singh() runs the method proposed by Singh (1981) for determining the importance of variables based on the squared generalized Mahalanobis distance. In his approach, the importance of the <span class="math inline">\(j\)</span>-th variable (<span class="math inline">\(j = 1, 2, ..., p\)</span>) on the calculation of the distance matrix can be obtained by:</p>
<p><span class="math display">\[
    S_{.j} = \sum_{i=1}^{n-1} \sum_{i'&gt;i}^{n} (x_{ij} - x_{i'j}) ({\bf x}_i - {\bf x}_{i'})^T {\Sigma}_{.j}^{-1} 
\]</span></p>
<p>where <span class="math inline">\(x_{ij}\)</span> and <span class="math inline">\(x_{i'j}\)</span> are the observation taken at the <span class="math inline">\(i\)</span>-th and <span class="math inline">\(i'\)</span>-th objects (individuals) for the <span class="math inline">\(j\)</span>-th variable, <span class="math inline">\({\bf x}_i\)</span> is the <span class="math inline">\(p\)</span>-variate vector of the <span class="math inline">\(i\)</span>-th object and <span class="math inline">\({\Sigma}_{.j}^{-1}\)</span> is the <span class="math inline">\(j\)</span>-th column of the inverse of the covariance matrix.</p>
<p>Since <span class="math inline">\(S_{.j}\)</span> is itself a measure of distance, it can be more appropriate to take the following proportion instead:</p>
<p><span class="math display">\[
        \frac{S_{.j}} {\sum_{j=1}^{p} S_{.j}} \in [0, 1]
\]</span></p>
<p>with the constraint <span class="math inline">\(\sum_{j=1}^{p} S_{.j} = \sum_{i=1}^{n-1} \sum_{i'&gt;i}^{n} D_{ii'}^2\)</span>.</p>
<p>Using the proportion enable us to determine the relative importance of each variable.</p>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h3>
<p>Using the residual covariance of the fitted MANOVA model, let us calculate the importance of the three variables to discriminating observations.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/singh.html">singh</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">maize</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span>
<span class="va">s</span></code></pre></div>
<pre><code>##                                 ED        NKPR           CD
## Singh statistic       2292.2558745 485.7898274 187.46962697
## Proportion               0.7729705   0.1638130   0.06321654
## Cumulative proportion    0.7729705   0.9367835   1.00000000
## attr(,"class")
## [1] "singh"</code></pre>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
<div id="tochers-clustering" class="section level1">
<h1 class="hasAnchor">
<a href="#tochers-clustering" class="anchor"></a>Tocher's clustering</h1>
<p>Cluster analysis consists of arranging multivariate observations into homogeneous clusters. There are several algorithms for cluster analysis, with different outcomes and objective functions. Tocher's optimization method allows one to establish mutually exclusive clusters, with no need to define the number of clusters. It has been widely used in studies of genetic/phenotypic diversity that are based on cluster analysis. Furthermore, Tocher's method can be used to determine the number of clusters in dendrograms.</p>
<p>Clusters are established according to an objective function that adopts an optimization criterion, which minimizes the average intra-cluster distance and maximizes the average inter-cluster distances (Silva &amp; Dias, 2013). <strong>biotools</strong> contains the method suggested by K.D. Tocher (Rao, 1952) for clustering objects, based on the algorithm:</p>
<ol style="list-style-type: decimal">
<li>(Input) Take a distance matrix, let us say <span class="math inline">\({\bf d}\)</span>, of size <span class="math inline">\(n\)</span>.</li>
<li>Define a clustering criterion, that is, a limit of distance at which to evaluate the inclusion of objects in a cluster in formation. Usually, this criterion is defined as follows: let <span class="math inline">\({\bf m}\)</span> be a vector of size <span class="math inline">\(n\)</span> containing the smallest distances involving each object, then take <span class="math inline">\(\theta = \max{({\bf m})}\)</span> to be the clustering criterion.</li>
<li>Locate the pair of objects with the smallest distance in <span class="math inline">\({\bf d}\)</span> to be the starting cluster.</li>
<li>Compute the average distance (<span class="math inline">\(d_{k(j)}\)</span>) of the starting cluster, say <span class="math inline">\(k\)</span>, to a certain object, say <span class="math inline">\(j\)</span>, that shows the smallest pairwise distance with each object in the starting cluster.</li>
<li>Compare the statistic evaluated at the step 4 with <span class="math inline">\(\theta\)</span>. Then, add the new object to the starting cluster if <span class="math inline">\(d_{k(j)} \leq \theta\)</span>. Otherwise, go to step 3 not considering the objects already clustered and start a new cluster.</li>
</ol>
<p>The process continues until the last remaining object is evaluated and either included in the last cluster formed or allocated to a new cluster. The function <code><a href="../reference/tocher.html">tocher()</a></code> performs optimization clustering and returns an object of class <code>tocher</code>, which contains the clusters formed, a numeric vector indicating the cluster of each object, a matrix of cluster distances and also the input - a class <code>dist</code> object.</p>
<div id="example-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1" class="anchor"></a>Example</h3>
<p>The 20 individuals (observation) from the maize data set are to be clustered. First, we need to comput the Mahalanobis generalized squared distance among them.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/D2.dist.html">D2.dist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">maize</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code>## [1]  0.2203346 61.4121118</code></pre>
<p>Then Tocher's method can be applied to determine clusters. For that we are using modified method (sequential algorithm) by Vasconcelos et al. (2007) and the residual covariance matrix.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">toc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tocher.html">tocher</a></span><span class="op">(</span><span class="va">d</span>, algorithm <span class="op">=</span> <span class="st">"sequential"</span><span class="op">)</span>
<span class="va">toc</span></code></pre></div>
<pre><code>## 
##           Tocher's Clustering 
## 
## Call: tocher.dist(d = d, algorithm = "sequential")
## 
## Cluster algorithm: sequential 
## Number of objects: 20 
## Number of clusters: 6 
## Most contrasting clusters: cluster 5 and cluster 6, with 
##    average intercluster distance: 42.88234
## 
## $`cluster 1`
## [1] 6  16 12 10
## 
## $`cluster 2`
## [1] 7  13 2  8 
## 
## $`cluster 3`
## [1] 15 20 4  5 
## 
## $`cluster 4`
## [1] 9  19 3  17
## 
## $`cluster 5`
## [1] 1  11 14
## 
## $`cluster 6`
## [1] 18</code></pre>
</div>
<div id="cluster-distances" class="section level2">
<h2 class="hasAnchor">
<a href="#cluster-distances" class="anchor"></a>Cluster distances</h2>
<p>After obtaining the clusters, it might be useful to know how divergent they are from each other. In this context, cluster distances are calculated from the original distance matrix through the function <code><a href="../reference/distClust.html">distClust()</a></code>. An intracluster distance is calculated by averaging all pairwise distances among objects in the cluster concerned. Likewise, the distance between two clusters is calculated by averaging all pairwise distances among objects in these clusters.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">toc</span><span class="op">$</span><span class="va">distClust</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>##           cluster 1 cluster 2 cluster 3 cluster 4 cluster 5 cluster 6
## cluster 1       3.6      14.3      11.8      15.4       9.9      29.6
## cluster 2      14.3       3.7      27.7      13.9      25.4       7.1
## cluster 3      11.8      27.7       3.5      15.1       7.5      41.1
## cluster 4      15.4      13.9      15.1       4.8      21.1      13.4
## cluster 5       9.9      25.4       7.5      21.1      12.6      42.9
## cluster 6      29.6       7.1      41.1      13.4      42.9       0.0</code></pre>
</div>
<div id="cophenetic-correlation" class="section level2">
<h2 class="hasAnchor">
<a href="#cophenetic-correlation" class="anchor"></a>Cophenetic correlation</h2>
<p>Clustering validation is widely applied for hierarchical and iterative methods. Some measures of internal validation for a Tocher's clustering outcome are implemented on biotools.</p>
<p>The approach presented by Silva (2013) is implemented by taking the cluster distances in order to build a cophenetic matrix for clustering performed through the Tocher's method. Their approach consists of taking the cophenetic distance among objects located in the same cluster as the intracluster distance and the cophenetic distance between objects of different clusters as the intercluster distance. Then, the Pearson's correlation between the elements of the original and cophenetic matrix can be taken as a cophenetic correlation. The function to be called is <code><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic()</a></code>, whose input is an object of class <code>tocher</code> and its output an object of class <code>dist</code>.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">toc</span><span class="op">)</span>  <span class="co"># cophenetic matrix</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">cop</span><span class="op">)</span>             <span class="co"># cophenetic correlation coefficient</span></code></pre></div>
<pre><code>## [1] 0.7320551</code></pre>
</div>
<div id="mantels-test" class="section level2">
<h2 class="hasAnchor">
<a href="#mantels-test" class="anchor"></a>Mantel's test</h2>
<p><strong>Is that cophenetic correlation significantly greater than zero?</strong> That quastion and others related to square matrix associations can be answered using Mantel's permutation test.</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mantelTest.html">mantelTest</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">cop</span>, nperm <span class="op">=</span> <span class="fl">900</span><span class="op">)</span></code></pre></div>
<p><img src="overview_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<pre><code>## 
##             Mantel's permutation test
## 
## Correlation: 0.7320551
## p-value: 0.001109878, based on 900 matrix permutations
## Alternative hypothesis: true correlation is greater than 0</code></pre>
</div>
</div>
<div id="discriminant-analysis-based-on-mahalanobis-distance" class="section level1">
<h1 class="hasAnchor">
<a href="#discriminant-analysis-based-on-mahalanobis-distance" class="anchor"></a>Discriminant analysis based on Mahalanobis distance</h1>
<p>A simple and efficient object classification rule is based on Mahalanobis distance. It consists of calculating the squared generalized Mahalanobis distances of each multivariate observation to the centre of each cluster. biotools performs this sort of discriminant analysis through <code><a href="../reference/D2.disc.html">D2.disc()</a></code>, as follows:</p>
<p>Consider the <span class="math inline">\(i\)</span>-th (<span class="math inline">\(i = 1, 2, ..., n_j\)</span>) <span class="math inline">\(p\)</span>-variate observation belonging to the <span class="math inline">\(j\)</span>-th (<span class="math inline">\(j = 1, 2, ..., k\)</span>) cluster, <span class="math inline">\({\bf x}_{ij}\)</span>. Let <span class="math inline">\(\bar{{\bf x}}_{j'}\)</span> be the vector of means of the <span class="math inline">\(j'\)</span>-th (<span class="math inline">\(j' = 1, 2, ..., k\)</span>) cluster. The Mahalanobis distance from this observation to the centre of this cluster is given by</p>
<p><span class="math display">\[
    D_{ij, j'}^2 = ({\bf x}_{ij} - \bar{{\bf x}}_{j'})^T {\hat{\Sigma}}_{pooled}^{-1} ({\bf x}_{ij} - \bar{{\bf x}}_{j'})
\]</span></p>
<p>where <span class="math inline">\({\hat{\Sigma}}_{pooled}\)</span> is the estimate of the pooled covariance matrix for clusters.</p>
<p>Now consider <span class="math inline">\(C_j\)</span> the random variable that represents the cluster at which the observation <span class="math inline">\({\bf x}_{ij}\)</span> lies. The predicted class <span class="math inline">\(\hat{C}_{j'}\)</span> for this observation is the one such that</p>
<p><span class="math display">\[
    j' \Rightarrow \min_{j' = 1}^{k} ( D_{ij, j'}^2 ) 
\]</span></p>
<p>i.e., the object is allocated to the cluster whose distance from its centre is the smallest.</p>
<p>The output is the Mahalanobis distances from each observation to the centre of each cluster, the pooled covariance matrix for clusters and the confusion matrix, which contains the number of correct classifications in the diagonal cells and misclassifications off-diagonal. In addition, a column misclass indicates (with an asterisk) where there was disagreement between the original classification (grouping) and the predicted one (pred).</p>
<div class="sourceCode"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/D2.disc.html">D2.disc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">maize</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, 
        grouping <span class="op">=</span> <span class="va">maize</span><span class="op">$</span><span class="va">family</span>, 
        pooled.cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## D2.disc.default(data = maize[, 1:3], grouping = maize$family, 
##     pooled.cov = cov(res))
## 
## Mahalanobis distances from each class and class prediction (first 6 rows):
##           X1        X2        X3        X4        X5 grouping pred misclass
## 1  0.6075575  9.712976 20.970574  9.584311  5.870589        1    1         
## 2  3.6521169  3.202266  6.936814 10.989061 12.524312        2    2         
## 3 16.5825884  4.874949  3.468493 10.094606 19.106220        3    3         
## 4 10.7383299 16.714143 31.501871  4.121057  3.496142        4    5        *
## 5 11.9533308 22.662364 47.834072  7.030199  2.268491        5    5         
## 6  1.7343324  4.486490 17.479342  8.732280  7.262779        1    1         
## 
## Class means:
##       NKPR       ED       CD
## 1 36.10502 4.349705 2.369759
## 2 32.27656 4.019219 2.321406
## 3 30.05977 3.639063 2.127031
## 4 30.99883 4.243906 2.367656
## 5 33.70898 4.458906 2.425625
## 
## Confusion matrix:
##   new 1 new 2 new 3 new 4 new 5
## 1     4     0     0     0     0
## 2     0     3     1     0     0
## 3     0     0     4     0     0
## 4     0     1     0     1     2
## 5     0     0     0     0     4</code></pre>
</div>
<div id="miscellanea" class="section level1">
<h1 class="hasAnchor">
<a href="#miscellanea" class="anchor"></a>Miscellanea</h1>
<p><em>biotools</em> also contains several other useful miscelaneous tools, such as the statistical tests for genetic covariance components, the exact test for seed lot heterogeneity, an approach for predicting spatial gene diversity and a function to perform path analysis dealing with collinearity.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Mantel, N. 1967. The detection of disease clustering and a generalized regression approach. Cancer Research 27:209–220.</p>
<p>Rao, C. R. 1952. Advanced statistical methods in biometric research. New York: John Wiley &amp; Sons.</p>
<p>Silva, A. R., and C. T. S. Dias. 2013. A cophenetic correlation coefficient for Tocher's method. Pesquisa Agropecuaria Brasileira 48: 589–96.</p>
<p>Singh, D. 1981. The relative importance of characters affecting genetic divergence. Indian Journal Genetics and Plant Breeding 41: 237-45.</p>
<p>Vasconcelos, E.S., Cruz, C.D., Bhering, L.L., Resende-Jr, M.F.R. 2007. Metodo Alternativo para Analise de Agrupamento. Pesquisa Agropecuaria Brasileira 42:1421-1428.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Anderson Rodrigo da Silva.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
