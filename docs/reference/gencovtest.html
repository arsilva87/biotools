<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Testing Genetic Covariance — gencovtest • biotools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Testing Genetic Covariance — gencovtest" />
<meta property="og:description" content="gencovtest() tests genetic covariance components from a MANOVA model. Two different approaches can
be used: (I) a test statistic that takes into account the genetic and environmental effects and (II) a test 
statistic that only considers the genetic information. The first type refers to tests based on the mean 
cross-products ratio, whose distribution is obtained via Monte Carlo simulation of Wishart matrices. The 
second way of testing genetic covariance refers to tests based upon an adaptation of Wilks' and Pillai's 
statistics for evaluating independence of two sets of variables. All these tests are described by Silva (2015)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biotools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/overview.html">biotools: an overview</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/arsilva87/biotools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Testing Genetic Covariance</h1>
    
    <div class="hidden name"><code>gencovtest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>gencovtest()</code> tests genetic covariance components from a MANOVA model. Two different approaches can
be used: (I) a test statistic that takes into account the genetic and environmental effects and (II) a test 
statistic that only considers the genetic information. The first type refers to tests based on the mean 
cross-products ratio, whose distribution is obtained via Monte Carlo simulation of Wishart matrices. The 
second way of testing genetic covariance refers to tests based upon an adaptation of Wilks' and Pillai's 
statistics for evaluating independence of two sets of variables. All these tests are described by Silva (2015).</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for manova</span>
<span class='fu'>gencovtest</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>geneticFactor</span>, gcov <span class='op'>=</span> <span class='cn'>NULL</span>, 
  residualFactor <span class='op'>=</span> <span class='cn'>NULL</span>, adjNrep <span class='op'>=</span> <span class='fl'>1</span>, 
  test <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"MCPR"</span>, <span class='st'>"Wilks"</span>, <span class='st'>"Pillai"</span><span class='op'>)</span>, 
  nsim <span class='op'>=</span> <span class='fl'>9999</span>, 
  alternative <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"two.sided"</span>, <span class='st'>"less"</span>, <span class='st'>"greater"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># S3 method for gencovtest</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, digits <span class='op'>=</span> <span class='fl'>4</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for gencovtest</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>var1</span>, <span class='va'>var2</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>an object of class <code>"manova"</code>.</p></td>
    </tr>
    <tr>
      <th>geneticFactor</th>
      <td><p>a character indicating the genetic factor from which to test covariance components.
	It must be declared as a factor in the manova object.</p></td>
    </tr>
    <tr>
      <th>gcov</th>
      <td><p>optional; a matrix containing estimates of genetic covariances to be tested. If 
	<code>NULL</code> (default), an estimate is obtained via method of moments.</p></td>
    </tr>
    <tr>
      <th>residualFactor</th>
      <td><p>optional; a character indicating a source in the manova model to be used as
	error term. If <code>NULL</code> (default), the usual term "Residuals" will be used.</p></td>
    </tr>
    <tr>
      <th>adjNrep</th>
      <td><p>a correction index for dealing with unbalanced data. See details.</p></td>
    </tr>
    <tr>
      <th>test</th>
      <td><p>a character indicating the test. It must be on of the following:
	<code>"MCPR"</code> - the empirical type-I test based on Mean Cross-Products Ratios via Wishart simulation,
	<code>"Wilks"</code> - a type-II test based on the partial Wilks' Lambda,
	<code>"Pillai"</code> - a type-II test based on the partial Pillai's statistic.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>the number of Monte Carlo simulations. Used only if <code>test = "MCPR"</code>.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>the type of alternative hypothesis. Used only if <code>test = "MCPR"</code>. So far,
	only the option <code>"two.sided"</code> is implemented.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>an object of class <code>"gencovtest"</code>.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>the number of digits to be displayed by the print method.</p></td>
    </tr>
    <tr>
      <th>var1</th>
      <td><p>a character of integer indicating one of the two response variable or its position.</p></td>
    </tr>
    <tr>
      <th>var2</th>
      <td><p>a character of integer indicating one of the two response variable or its position.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The genetic covariance matrix is currently estimated via method of moments, following the equation:
$$G = (Mg - Me) / (nrep * adjNrep)$$
where \(Mg\) and \(Me\) are the matrices of mean cross-products associated with the genetic factor and 
the residuals, respectively; \(nrep\) is the number of replications, calculated as the ratio between the 
total number of observations and the number of levels of the genetic factor; \(adjNrep\) is supposed to 
adjust nrep, specially when estimating \(G\) from unbalanced data.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>gencovtest</code>, a list of</p>
<dt>gcov</dt><dd><p>a p-dimensional square matrix containing estimates of the genetic covariances.</p></dd>
  <dt>gcor</dt><dd><p>a p-dimensional square matrix containing estimates of the genetic correlations.</p></dd>
  <dt>test</dt><dd><p>the test (as input).</p></dd>
  <dt>statistics</dt><dd><p>a p-dimensional square matrix containing the <code>test</code> statistics. 
	If <code>test = "MCPR"</code> the mean cross-products ratios are computed; if <code>test = "Wilks"</code>
	the Wilks' Lambda is; and <code>test = "Pillai"</code> results on Pillai's \(Tn\).</p></dd>
  <dt>p.values</dt><dd><p>a p-dimensional square matrix containing the associated p-values.</p></dd>
  <dt>alternative</dt><dd><p>the type of alternative hypothesis (as input).</p></dd>
  <dt>X2</dt><dd><p>a p-dimensional square matrix containing the Chi-square (D.f. = 1) approximation for Wilks's 
	and Pillai's statistics. Stored only if one of these two tests is chosen.</p></dd>
  <dt>simRatio</dt><dd><p>an array consisting of <code>nsim</code> p-dimensional matrices containing the simulated mean 
	cross-products ratios.</p></dd>
  <dt>dfg</dt><dd><p>the number of degrees of freedom associated with the genetic factor.</p></dd>
  <dt>dfe</dt><dd><p>the number of degrees of freedom associated with the residual term.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Silva, A.R. (2015) <em>On Testing Genetic Covariance</em>. LAP Lambert Academic Publishing. ISBN 3659716553</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Anderson Rodrigo da Silva &lt;anderson.agro@hotmail.com&gt;</p>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    <p>When using the MCPR test, be aware that <code>dfg</code> should be equal or greater than the number of variables (p). 
Otherwise the simulation of Wishart matrices may not be done.</p>
<p>A collinearity diagnosis is carried out using the condition number (CN), for the inferences may be affected by the 
quality of \(G\). Thus, if CN &gt; 100, a warning message is displayed.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/manova.html'>manova</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># MANOVA</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>maize</span><span class='op'>)</span>
<span class='va'>M</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/manova.html'>manova</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>NKPR</span>, <span class='va'>ED</span>, <span class='va'>CD</span>, <span class='va'>PH</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>family</span> <span class='op'>+</span> <span class='va'>env</span>, data <span class='op'>=</span> <span class='va'>maize</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>M</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           Df Pillai approx F num Df den Df    Pr(&gt;F)    
#&gt; family     4 2.2699   3.9361     16     48 0.0001151 ***
#&gt; env        3 1.6963   3.5782     12     33 0.0018017 ** 
#&gt; Residuals 12                                            
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</div><div class='input'>
<span class='co'># Example 1 - MCPR</span>
<span class='va'>t1</span> <span class='op'>&lt;-</span> <span class='fu'>gencovtest</span><span class='op'>(</span>obj <span class='op'>=</span> <span class='va'>M</span>, geneticFactor <span class='op'>=</span> <span class='st'>"family"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: the genetic covariance matrix presents severe collinearity</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>t1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;           Genetic Covariance Test 
#&gt; 
#&gt; Genetic (Co)variances and Correlations (upper triangular):
#&gt;        NKPR     ED      CD      PH
#&gt; NKPR 4.5105 0.7641  0.6817  0.1268
#&gt; ED   0.5148 0.1006  1.0186  0.1755
#&gt; CD   0.1486 0.0332  0.0105 -0.1109
#&gt; PH   0.0370 0.0077 -0.0016  0.0189
#&gt; 
#&gt; Test: MCPR
#&gt; Alternative hypothesis: two.sided 
#&gt; 
#&gt; Mean Sq and Cross-Prods Ratios and p-values (upper triangular) 
#&gt; based on 9999 estimates:
#&gt;         NKPR      ED      CD     PH
#&gt; NKPR  4.9312  0.0191  0.0690 0.2388
#&gt; ED   12.8014 21.6422  0.0016 0.0989
#&gt; CD    6.3903 11.2840  4.8367 0.6313
#&gt; PH    3.3012  8.2161 -0.7012 8.4603</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>t1</span>, <span class='st'>"ED"</span>, <span class='st'>"PH"</span><span class='op'>)</span>
</div><div class='img'><img src='gencovtest-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Example 2 - Pillai</span>
<span class='va'>t2</span> <span class='op'>&lt;-</span> <span class='fu'>gencovtest</span><span class='op'>(</span>obj <span class='op'>=</span> <span class='va'>M</span>, geneticFactor <span class='op'>=</span> <span class='st'>"family"</span>, test <span class='op'>=</span> <span class='st'>"Pillai"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: the genetic covariance matrix presents severe collinearity</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>t2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;           Genetic Covariance Test 
#&gt; 
#&gt; Genetic (Co)variances and Correlations (upper triangular):
#&gt;        NKPR     ED      CD      PH
#&gt; NKPR 4.5105 0.7641  0.6817  0.1268
#&gt; ED   0.5148 0.1006  1.0186  0.1755
#&gt; CD   0.1486 0.0332  0.0105 -0.1109
#&gt; PH   0.0370 0.0077 -0.0016  0.0189
#&gt; 
#&gt; Test: Pillai
#&gt; 
#&gt; Chi-Sq (df = 1) approx. and p-values (upper triangular):
#&gt;        NKPR     ED     CD     PH
#&gt; NKPR     NA 0.1265 0.1728 0.7997
#&gt; ED   2.3355     NA 0.0416 0.7256
#&gt; CD   1.8588 4.1500     NA 0.8245
#&gt; PH   0.0644 0.1232 0.0492     NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>t2</span>, <span class='st'>"ED"</span>, <span class='st'>"PH"</span><span class='op'>)</span>
</div><div class='img'><img src='gencovtest-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># End (not run)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Anderson Rodrigo da Silva.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


